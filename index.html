<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BA_spectralGate - VST Plugin</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=AW-16935186142"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "AW-16935186142");
    </script>

    <!-- Google Conversion Script -->
    <script>
      function gtag_report_conversion(url) {
        var callback = function () {
          if (typeof url != "undefined") {
            window.location = url;
          }
        };
        gtag("event", "conversion", {
          send_to: "AW-16935186142/lGhmCK7Oo7saEN7dqYs_",
          value: 0.1,
          currency: "EUR",
          event_callback: callback,
        });
        return false;
      }
    </script>

    <!-- Stylesheet -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Language Detection -->
    <script>
      window.onload = () => {
        const isJapanese = navigator.language === "ja";
        document.querySelectorAll("[data-en]").forEach((el) => {
          el.innerText = isJapanese
            ? el.getAttribute("data-ja")
            : el.getAttribute("data-en");
        });
      };
    </script>
  </head>

  <body>
    <div class="container">
      <div class="content">
        <h1 data-en="BA_spectralGate" data-ja="BA_スペクトラルゲート">
          BA_spectralGate
        </h1>
        <p
          data-en="BA_spectralGate is an audio plugin designed to transform your sound with spectral gating. Created as part of my bachelor's thesis, this tool adds subtle yet interesting artifacts to your audio, helping you create unique textures for sound design and music production."
          data-ja="BA_スペクトラルゲートは、スペクトルゲーティングによって音を変換するために設計されたオーディオプラグインです。私の学士論文の一環として作成されたこのツールは、微妙で興味深いアーティファクトを音に追加し、サウンドデザインや音楽制作にユニークなテクスチャを生み出します。"
        ></p>
      </div>

      <div class="image-section">
        <img
          class="plugin-img"
          src="img/ba_specgate.png"
          alt="Spectral Gate Plugin Interface"
          onerror="this.style.display='none'"
        />
      </div>

      <div class="form-section">
        <h2
          data-en="Try it for free when it's ready!"
          data-ja="準備ができたら無料で試してみてください！"
        ></h2>
        <p
          data-en="Sign up below, and you'll be the first to know when it's available!"
          data-ja="以下にサインアップすると、利用可能になったときに最初にお知らせします！"
        ></p>

        <div class="form-group">
          <input
            type="email"
            id="email"
            placeholder="Enter your email address"
            data-en="Enter your email address"
            data-ja="メールアドレスを入力してください"
            required
          />
        </div>
        <button
          data-en="Get Updates"
          data-ja="アップデートを受け取る"
          onclick="submitEmail()"
        ></button>
        <div id="msg"></div>
      </div>

      <div class="footer">
        <p data-en="All rights reserved." data-ja="全ての権利を保有します。">
          All rights reserved.
        </p>
      </div>
    </div>

    <img src="img/glitter.gif" alt="Sparkle Effect" class="sparkle-overlay" />

    <script>
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbwk6lTQtecKXZ2gdOmSBKP7b0301UNpyPF1iuM0fJs5SmOkc2KElaPgbeMT3gHOVIBD/exec";
      const startTime = Date.now();
      let hasConverted = false;

      fetch(scriptURL).catch(() => {});

      function submitEmail() {
        const emailField = document.getElementById("email");
        const email = emailField.value.trim();
        const msg = document.getElementById("msg");

        msg.className = "";
        msg.innerText = "";

        const valid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        if (!valid) {
          msg.innerText =
            navigator.language === "ja"
              ? "有効なメールアドレスを入力してください。"
              : "Please enter a valid email address.";
          msg.className = "error";
          return;
        }

        hasConverted = true;
        const timeSpent = Math.round((Date.now() - startTime) / 1000);

        fetch(scriptURL, {
          method: "POST",
          body: new URLSearchParams({
            email,
            time: timeSpent,
            converted: "yes",
          }),
        })
          .then(() => {
            msg.innerText =
              navigator.language === "ja"
                ? "ご登録ありがとうございます。準備ができ次第ご連絡いたします。"
                : "Thank you for your interest. We'll be in touch!";
            msg.className = "success";
            emailField.value = "";
            gtag_report_conversion();
          })
          .catch(() => {
            msg.innerText =
              navigator.language === "ja"
                ? "エラーが発生しました。後でもう一度お試しください。"
                : "Something went wrong. Please try again later.";
            msg.className = "error";
          });
      }

      document
        .getElementById("email")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            submitEmail();
          }
        });
    </script>
  </body>
</html>
